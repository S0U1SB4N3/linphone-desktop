\section{telephonyevents.\+h File Reference}
\label{telephonyevents_8h}\index{telephonyevents.\+h@{telephonyevents.\+h}}


Receiving and sending telephone events (R\+F\+C2833)  


{\ttfamily \#include $<$ortp/rtpsession.\+h$>$}\newline
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ \+\_\+telephone\+\_\+event}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{telephonyevents_8h_ab091cd5f688bc33209cb59a056a7f37c}} 
\#define {\bfseries T\+E\+L\+E\+P\+H\+O\+N\+Y\+\_\+\+E\+V\+E\+N\+T\+S\+\_\+\+A\+L\+L\+O\+C\+A\+T\+E\+D\+\_\+\+S\+I\+ZE}~(4$\ast$sizeof(\textbf{ telephone\+\_\+event\+\_\+t}))
\item 
\mbox{\label{telephonyevents_8h_af035c1e5ee22a73492d87c20d75bb22a}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+0}~(0)
\item 
\mbox{\label{telephonyevents_8h_abf9ac8bf924eb4c066e546a693380229}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+1}~(1)
\item 
\mbox{\label{telephonyevents_8h_a6f926a88a750f35ae969e2b41d471cfb}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+2}~(2)
\item 
\mbox{\label{telephonyevents_8h_a2664875987d68e0a3c36cf5d2e45e21a}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+3}~(3)
\item 
\mbox{\label{telephonyevents_8h_a4b37152d54027fbb6285a86f5eb01e1e}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+4}~(4)
\item 
\mbox{\label{telephonyevents_8h_aee78f60227098c3622e76bdc95a753c7}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+5}~(5)
\item 
\mbox{\label{telephonyevents_8h_a452e6ed6839ea48eeb6d3bd7c69aae94}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+6}~(6)
\item 
\mbox{\label{telephonyevents_8h_a460f32ae9b51432e2fb54492510ae561}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+7}~(7)
\item 
\mbox{\label{telephonyevents_8h_aca47e22b3beb2e218407e029129cafe8}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+8}~(8)
\item 
\mbox{\label{telephonyevents_8h_aa587614010667c672ec3caa07093505d}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+9}~(9)
\item 
\mbox{\label{telephonyevents_8h_ab0aa5b20d2d31db35bac4fd8c6658eb3}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+\+S\+T\+AR}~(10)
\item 
\mbox{\label{telephonyevents_8h_a5d5f8db428d9b715399010c5ae059178}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+\+P\+O\+U\+ND}~(11)
\item 
\mbox{\label{telephonyevents_8h_a1217d0b7995679d3eb7a6445cc647f59}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+A}~(12)
\item 
\mbox{\label{telephonyevents_8h_aef6cfaef85c9feee12fa2b81a233d2c1}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+B}~(13)
\item 
\mbox{\label{telephonyevents_8h_a22d83aeeec14757d6dfa7221f187042b}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+C}~(14)
\item 
\mbox{\label{telephonyevents_8h_aa21a7bc04a2e87dde3c34bcf79a666c5}} 
\#define {\bfseries T\+E\+V\+\_\+\+D\+T\+M\+F\+\_\+D}~(15)
\item 
\mbox{\label{telephonyevents_8h_ab59963c772565026ba3e719c722512d4}} 
\#define {\bfseries T\+E\+V\+\_\+\+F\+L\+A\+SH}~(16)
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
\mbox{\label{telephonyevents_8h_a998c7fcf7150461aef2c75dc797df90c}} 
typedef struct \textbf{ \+\_\+telephone\+\_\+event} {\bfseries telephone\+\_\+event\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \textbf{ rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported} (\textbf{ Rtp\+Session} $\ast$session)
\item 
int \textbf{ rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported} (\textbf{ Rtp\+Session} $\ast$session)
\item 
int \textbf{ rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported} (\textbf{ Rtp\+Session} $\ast$session)
\item 
\textbf{ mblk\+\_\+t} $\ast$ \textbf{ rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet} (\textbf{ Rtp\+Session} $\ast$session, int start)
\item 
int \textbf{ rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event} (\textbf{ Rtp\+Session} $\ast$session, \textbf{ mblk\+\_\+t} $\ast$packet, uint8\+\_\+t event, int end, uint8\+\_\+t volume, uint16\+\_\+t duration)
\item 
int \textbf{ rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event} (\textbf{ Rtp\+Session} $\ast$session, \textbf{ mblk\+\_\+t} $\ast$packet, \textbf{ telephone\+\_\+event\+\_\+t} $\ast$$\ast$tab)
\item 
int \textbf{ rtp\+\_\+session\+\_\+send\+\_\+dtmf} (\textbf{ Rtp\+Session} $\ast$session, char dtmf, uint32\+\_\+t userts)
\item 
int \textbf{ rtp\+\_\+session\+\_\+send\+\_\+dtmf2} (\textbf{ Rtp\+Session} $\ast$session, char dtmf, uint32\+\_\+t userts, int duration)
\item 
\mbox{\label{telephonyevents_8h_a784ea862a1eee91b91baf6a0bfd4e9b3}} 
void {\bfseries rtp\+\_\+session\+\_\+check\+\_\+telephone\+\_\+events} (\textbf{ Rtp\+Session} $\ast$session, \textbf{ mblk\+\_\+t} $\ast$m0)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Receiving and sending telephone events (R\+F\+C2833) 



\subsection{Function Documentation}
\mbox{\label{telephonyevents_8h_ae76f4651f4aa5fe57bfb28e32df9425f}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event@{rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event}}
\index{rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event@{rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session,  }\item[{\textbf{ mblk\+\_\+t} $\ast$}]{packet,  }\item[{uint8\+\_\+t}]{event,  }\item[{int}]{end,  }\item[{uint8\+\_\+t}]{volume,  }\item[{uint16\+\_\+t}]{duration }\end{DoxyParamCaption})}


\begin{DoxyParams}{Parameters}
{\em session} & a rtp session. \\
\hline
{\em packet} & a rtp packet as a mblk\+\_\+t \\
\hline
{\em event} & the event type as described in rfc2833, ie one of the T\+E\+V\+\_\+$\ast$ macros. \\
\hline
{\em end} & a boolean to indicate if the end bit should be set. (end of tone) \\
\hline
{\em volume} & the volume of the telephony tone, as described in rfc2833 \\
\hline
{\em duration} & the duration of the telephony tone, in timestamp unit.\\
\hline
\end{DoxyParams}
Adds a named telephony event to a rtp packet previously allocated using \doxyref{rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet()}{p.}{telephonyevents_8h_a2bcdb4dc9c3bee5e7c54d03a0032f831}.

\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_a2bcdb4dc9c3bee5e7c54d03a0032f831}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet@{rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet}}
\index{rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet@{rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet()}
{\footnotesize\ttfamily \textbf{ mblk\+\_\+t}$\ast$ rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session,  }\item[{int}]{start }\end{DoxyParamCaption})}

Allocates a new rtp packet to be used to add named telephony events. The application can use then \doxyref{rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event()}{p.}{telephonyevents_8h_ae76f4651f4aa5fe57bfb28e32df9425f} to add named events to the packet. Finally the packet has to be sent with \doxyref{rtp\+\_\+session\+\_\+sendm\+\_\+with\+\_\+ts()}{p.}{rtpsession_8h_afda0872c335c06a86a45ca4591a8b7ee}.


\begin{DoxyParams}{Parameters}
{\em session} & a rtp session. \\
\hline
{\em start} & boolean to indicate if the marker bit should be set.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a message block containing the rtp packet if successfull, N\+U\+LL if the rtp session cannot support telephony event (because the rtp profile it is bound to does not include a telephony event payload type). 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_a2b92978f94e772570c0811605a590549}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event@{rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event}}
\index{rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event@{rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+read\+\_\+telephone\+\_\+event (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session,  }\item[{\textbf{ mblk\+\_\+t} $\ast$}]{packet,  }\item[{\textbf{ telephone\+\_\+event\+\_\+t} $\ast$$\ast$}]{tab }\end{DoxyParamCaption})}

Reads telephony events from a rtp packet. {\itshape $\ast$tab} points to the beginning of the event buffer.


\begin{DoxyParams}{Parameters}
{\em session} & a rtp session from which telephony events are received. \\
\hline
{\em packet} & a rtp packet as a mblk\+\_\+t. \\
\hline
{\em tab} & the address of a pointer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of events in the packet if successfull, 0 if the packet did not contain telephony events. 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_aa293218d9bda13e0a30bd71140ad49f2}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported@{rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported}}
\index{rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported@{rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+recv\+\_\+telephone\+\_\+events\+\_\+supported (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session }\end{DoxyParamCaption})}

Tells whether telephone event payload type is supported for receiving within the context of the rtp session. 
\begin{DoxyParams}{Parameters}
{\em session} & a rtp session\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the payload type number used for telephony events if found, -\/1 if not found. 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_ae6ec6661b0d2cb3df245438e0f658fc6}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+send\+\_\+dtmf@{rtp\+\_\+session\+\_\+send\+\_\+dtmf}}
\index{rtp\+\_\+session\+\_\+send\+\_\+dtmf@{rtp\+\_\+session\+\_\+send\+\_\+dtmf}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+send\+\_\+dtmf()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+send\+\_\+dtmf (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session,  }\item[{char}]{dtmf,  }\item[{uint32\+\_\+t}]{userts }\end{DoxyParamCaption})}

This functions creates telephony events packets for dtmf and sends them. It uses \doxyref{rtp\+\_\+session\+\_\+create\+\_\+telephone\+\_\+event\+\_\+packet()}{p.}{telephonyevents_8h_a2bcdb4dc9c3bee5e7c54d03a0032f831} and \doxyref{rtp\+\_\+session\+\_\+add\+\_\+telephone\+\_\+event()}{p.}{telephonyevents_8h_ae76f4651f4aa5fe57bfb28e32df9425f} to create them and finally \doxyref{rtp\+\_\+session\+\_\+sendm\+\_\+with\+\_\+ts()}{p.}{rtpsession_8h_afda0872c335c06a86a45ca4591a8b7ee} to send them.


\begin{DoxyParams}{Parameters}
{\em session} & a rtp session \\
\hline
{\em dtmf} & a character meaning the dtmf (ex\+: \textquotesingle{}1\textquotesingle{}, \textquotesingle{}\#\textquotesingle{} , \textquotesingle{}9\textquotesingle{} ...) \\
\hline
{\em userts} & the timestamp \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successfull, -\/1 if the session cannot support telephony events or if the dtmf given as argument is not valid. 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_a6be95ca243aaefcb23c90450c2900fb6}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+send\+\_\+dtmf2@{rtp\+\_\+session\+\_\+send\+\_\+dtmf2}}
\index{rtp\+\_\+session\+\_\+send\+\_\+dtmf2@{rtp\+\_\+session\+\_\+send\+\_\+dtmf2}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+send\+\_\+dtmf2()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+send\+\_\+dtmf2 (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session,  }\item[{char}]{dtmf,  }\item[{uint32\+\_\+t}]{userts,  }\item[{int}]{duration }\end{DoxyParamCaption})}

A variation of \doxyref{rtp\+\_\+session\+\_\+send\+\_\+dtmf()}{p.}{telephonyevents_8h_ae6ec6661b0d2cb3df245438e0f658fc6} with duration specified.


\begin{DoxyParams}{Parameters}
{\em session} & a rtp session \\
\hline
{\em dtmf} & a character meaning the dtmf (ex\+: \textquotesingle{}1\textquotesingle{}, \textquotesingle{}\#\textquotesingle{} , \textquotesingle{}9\textquotesingle{} ...) \\
\hline
{\em userts} & the timestamp \\
\hline
{\em duration} & duration of the dtmf in timestamp units \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if successfull, -\/1 if the session cannot support telephony events or if the dtmf given as argument is not valid. 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_a3983865006c85c4fba770c79c6addd09}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported@{rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported}}
\index{rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported@{rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+send\+\_\+telephone\+\_\+events\+\_\+supported (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session }\end{DoxyParamCaption})}

Tells whether telephone event payload type is supported for send within the context of the rtp session. 
\begin{DoxyParams}{Parameters}
{\em session} & a rtp session\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the payload type number used for telephony events if found, -\/1 if not found. 
\end{DoxyReturn}
\mbox{\label{telephonyevents_8h_a5a02d3fbbb0ae7eb98827435b85101a7}} 
\index{telephonyevents.\+h@{telephonyevents.\+h}!rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported@{rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported}}
\index{rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported@{rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported}!telephonyevents.\+h@{telephonyevents.\+h}}
\subsubsection{rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported()}
{\footnotesize\ttfamily int rtp\+\_\+session\+\_\+telephone\+\_\+events\+\_\+supported (\begin{DoxyParamCaption}\item[{\textbf{ Rtp\+Session} $\ast$}]{session }\end{DoxyParamCaption})}

Tells whether telephony events payload type is supported within the context of the rtp session. 
\begin{DoxyParams}{Parameters}
{\em session} & a rtp session\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the payload type number used for telephony events if found, -\/1 if not found. 
\end{DoxyReturn}
